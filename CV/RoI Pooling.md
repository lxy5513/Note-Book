# RoI Pooling

> RoI pooling 整合了整个模型，把CNN、变换层、SVM分类器、bbox回归这几个模块整到一起，大家一起计算

> 新的模型效果很好，因为多个训练阶段合并了，训练后面的阶段可以跟新前面阶段的参数，模型收敛的更好了。因为多个训练阶段合并，候选区域不需要写入磁盘，一直在显存中，训练速度大大的提升了。



### RoI层是个啥

RoI层的作用和SPPNet中的SPP层作用类似:承上启下。

- 承上: 接收在每个候选区域在feature map上投影出的特征patch，输出长度固定的特征向量。
- 启下: 特征向量的长度固定的原因为了对付FC层的特殊要求。

说白了就是如何把不同尺寸的侯选区域提取特征变换成为固定大小的特征向量。

**RoI层是特殊的SPP层，RoI层是使用单个尺度的SPP层(为什么不用多个尺度的原因是多个尺度准确率提升不高，但是计算量成倍的翻)**

![](/Users/liuxingyu/Pictures/markdown/rol poolingg.png)



### RoI layer Forward

RoI层将候选区域分为 H×W块。对每个小块做max-pooling.将候选区的局部特征映射转变为大小统一的数据，送入下一层。

RoI层的反向传播，这就让整个模型能从FC层传播到卷积层了，剩下的就是把SVM分类器和bbox回归整到一起

